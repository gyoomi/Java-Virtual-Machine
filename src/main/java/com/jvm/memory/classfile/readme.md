# 第三部分 虚拟机执行子系统
## 六、类文件机构
### 6.1 概述
### 6.2 无关性的基石
Write Once,Run Anywhere!
### 6.3 class文件的结构
1. 对数量、顺序、大小、分隔符等都是有很严格的限制和要求的
2. 表示

    ![](./asserts/001.png)
#### 6.3.1 魔数和Class文件版本
1. 每个class文件的头4个字节称为魔数（Magic Number）；作用：确认这个class文件是否为虚拟机接受的class文件；在计算机中使用很广泛；
2. 魔数后面是第四个字节是Class文件的版本号；第5-6个字节是次版本号（Minor Version）；第7、8个字节是主版本号；Java的版本号是从45开始的
#### 6.3.2 常量池
1. 主次版本号后面就是常量池位置
2. class文件资源仓库
3. class文件结构中和其他项目关联最多的数据类型；占用class空间最大的数据之一；第一个表类型数据项目
4. 常量池入口处会放置一个容量标识（内存偏移地址0x00000008）
5. 分为字面量（符合java层面的常量）和引用符号（编译原理）两大类
6. 符号引用
   1. 类或接口的全限定名
   2. 字段名称和描述符
   3. 方法名称和描述符
7. 常量池的项目类型

   ![](./asserts/002.png)
#### 6.3.3 访问标志
1. 常量池结束后两个字节代表访问标志(access_flag)；
2. 这些标识符作用：比如这个是类还是接口，是否定义成public类型，是否定义了abstract类型，类有没有被声明成final类型，
3. 说明

   ![](./asserts/003.png)
#### 6.3.4 类索引、父类索引和接口索引集合
1. 类索引、父类索引都是一个u2类型的数据；而接口则是一组u2类型的数据的集合
2. 类索引于用于确定这个类的全限定名
3. 父类索引用于确定父类索引的全限定名，并且只有一个。object没有。
4. 接口索引集合用来描述该类实现了那些接口，也就是从左到右的顺序的集合
#### 6.3.5 字段表集合
#### 6.3.6 方法表集合
#### 6.3.7 属性表集合
### 6.4 字节码指令介绍
1. 虚拟机指令是由一个字节字节长度、代表着某种特定操作含义的数字（称为操作码，Opcode）
   以及跟随其后的零至多个代表此操作所需参数（操作数，Operands）而构成。
2. 因为Java虚拟机是面向操作数栈而不是寄存器的结构，所以大多数指令不包含操作数，只包含操作码。
3. Java虚拟机的长度为一个字节，这就说明指令集操作码的总数不能超过256条
4. 这种特点导致在解释指令时会损失部分性能，但是代码精小，可以高效传输
### 6.4.1 字节码与数据类型
### 6.4.2 加载和存储指令
1. 用于将数据在栈帧中局部变量表和操作栈之间来回传输
2. 将一个局部变量加载到操作栈：iload、iload_<n>、aload、aload_<n>
3. 将一个数值从操作栈中存储到局部变量表中：istore、istore_<n>、astore、astore_<n>
4. 将一个常量加载到操作栈中去：dipush、sipush














































